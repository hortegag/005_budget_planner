<!DOCTYPE html>
<html
    xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout/default}">
<head>
<title th:text="#{people.list.title}"></title>


<!-- 
<script
    th:src="@{/webjars/jquery/3.3.1-1/jquery.js}"
    src=""></script>
 -->
<link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/octicons/4.4.0/font/octicons.css">

<link
    rel="stylesheet"
    th:href="@{/jqgrid/css/ui.jqgrid-bootstrap4.css}" />



<script
    th:src="@{/jqgrid/js/i18n/grid.locale-en.js}"
    src=""></script>

<script
    th:src="@{/jqgrid/js/jquery.jqGrid.min.js}"
    src=""></script>

</head>
<body>
    <div layout:fragment="content">

        <h1
            class="mt-5"
            th:text="#{people.list.title}"></h1>
        <!-- You cand add the action attribute or you can skip it, If you skip it the browser will call the same url in the bar direction but in the case with a post method. -->
        <!-- th:action="@{/identificationType/list}" -->
        <p>////////////////////////////////////////////////////////////////////////////////////////////////////////////</p>




        <table id="list">
            <tr>
                <td />
            </tr>
        </table>

        <div id="pager"></div>

        <form
            action="#"
            th:object="${searchIdentificationTypeForm}"
            method="post"
            autocomplete="off">

            <div class="form-group">
                <label
                    for="searchIdentification"
                    th:text="#{identificationType.list.search.label}">searchIdentification</label>


                <input
                    id="searchIdentification"
                    type="text"
                    th:field="*{name}"
                    name="searchName"
                    class="form-control"
                    th:placeholder="#{identificationType.list.search.input.placeholder}" />
            </div>
            <!-- 
			<input type="submit" class="btn btn-primary"
				th:value="#{identificationType.list.search.button}" />
				 -->

            <input
                id="newSearch"
                class="btn btn-primary"
                name="_eventId_search"
                type="submit"
                th:value="#{identificationType.list.search.button}"></input>
            <p>
                <!-- <input type="text" name="searchName" /> -->
                <!--	<label for="searchIdentification"
					th:text="#{identificationType.list.search.label}">searchIdentification</label>
				<input id="text" type="text" name="searchName" />  -->
            </p>
            <!-- <input type="submit" value="Search" /> -->
            <!--<input type="submit"
				th:value="#{identificationType.list.search.button}" />-->
        </form>


        <h2
            class="mt-5"
            th:text="#{identificationType.list.search.result.title}"></h2>

        <!-- 
		<form action="#" method="post"> -->

        <hr />

        <form
            action="#"
            method="post">
            <input
                id="addIdentificationType"
                class="btn btn-primary"
                name="_eventId_add"
                type="submit"
                th:value="#{identificationType.list.add.button}"></input>
        </form>

        <div
            class="mt-5"
            th:if="${#lists.isEmpty(peoples)}">
            <div
                class="alert alert-warning"
                role="alert">
                <p th:text="#{identificationType.list.search.empty.results}"></p>
            </div>
        </div>
        <div
            class="mt-5"
            th:unless="${#lists.isEmpty(peoples)}">
            <table class="table table-striped">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col">#</th>
                        <th
                            scope="col"
                            th:text="#{identificationType.list.search.table.id}"></th>
                        <th
                            scope="col"
                            th:text="#{identificationType.list.search.table.name}"></th>
                        <th
                            scope="col"
                            th:text="#{identificationType.list.search.table.mnemonic}"></th>
                        <th
                            scope="col"
                            th:text="#{identificationType.list.search.table.description}"></th>
                        <th
                            scope="col"
                            th:text="#{identificationType.list.search.table.edit}"></th>

                        <th
                            scope="col"
                            th:text="#{identificationType.list.search.table.delete}"></th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="people: ${peoples}">
                        <th scope="row"></th>
                        <td th:text="${people.id}" />
                        <td th:text="${people.name}" />
                        <td th:text="${people.lastName}" />
                        <td th:text="${people.email}" />



                        <td>
                            <!-- <a href="#" th:href="@{${flowExecutionUrl}(id=*{identification.id},_eventId='edit')}" >  -->
                            <a
                                href="#"
                                th:href="@{'~'+${flowExecutionUrl}(id=*{people.id},_eventId=edit)}">
                                <button
                                    type="button"
                                    class="btn btn-light"
                                    aria-label="Edit user">
                                    <i class="fas fa-pencil-alt"></i>
                                </button>
                            </a>
                        </td>
                        <td>
                            <a
                                href="#"
                                th:href="@{'~'+${flowExecutionUrl}(id=*{people.id},_eventId=delete)}">
                                <button
                                    type="button"
                                    class="btn btn-light"
                                    aria-label="Delete user">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </a>
                        </td>
                    </tr>
                </tbody>
            </table>
                
            <div th:insert="peopleFlow/paginationBar.html :: paginationbar"></div>
            <p></p>

        </div>
        <!-- </form>  -->

        <script
            type="text/javascript"
            th:inline="javascript">
									$.jgrid.defaults.styleUI = 'Bootstrap4';
									//$.jgrid.defaults.iconSet = 'Octicons';
									$.jgrid.defaults.iconSet = "fontAwesome";
									$.jgrid.defaults.width = 'auto';
									$.jgrid.defaults.responsive = true;

									var urlList = '[(@{/people/listgrid})]';
									var tableId = '[(#{people.list.search.table.id})]';
									var tableName = '[(#{people.list.search.table.name})]';
									var tableLastName = '[(#{people.list.search.table.lastName})]';
									var tableEmail = '[(#{people.list.search.table.email})]';
									var tableBornDate = '[(#{people.list.search.table.bornDate})]';
									var tableIdentification = '[(#{people.list.search.table.identification})]';

									//var testEditTwo = '[[${flowExecutionUrl}]]';
									var testEditTwo = '[(${flowExecutionUrl})]';
									var testEditTwo = '[(@{"~"+${flowExecutionUrl}})] ';
									var testEditTwo = "[(@{'~'+${flowExecutionUrl}(_eventId=edit)})]";
                                    var testDeleteTwo = "[(@{'~'+${flowExecutionUrl}(_eventId=delete)})]";
                                    

									console.log("test:" + urlList);
									$(function() {
										$("#list")
												.jqGrid(
														{
															url : urlList,
															datatype : 'json',
															mtype : 'GET',
															colNames : [
																	'Actions',
																	tableName,
																	tableLastName,
																	tableEmail,
																	tableBornDate,
																	tableIdentification ],
															colModel : [
																	{
																		name : 'act',
																		index : 'act',
																		width : 75,
																		sortable : false
																	},
																	{
																		name : 'name',
																		index : 'name',
																		width : 100
																	},
																	{
																		name : 'lastName',
																		index : 'lastName',
																		width : 100
																	},
																	{
																		name : 'email',
																		index : 'email',
																		width : 100
																	},
																	{
																		name : 'bornDate',
																		index : 'bornDate',
																		width : 100
																	},
																	{
																		name : 'identification',
																		index : 'identification',
																		width : 100
																	}

															],
															jsonReader : {
																root : "peopleData",
																page : "currentPage",
																total : "totalPages",
																records : "totalRecords",
																repeatitems : false,
																id : "id"
															},
															//styleUI : 'Bootstrap',
															//guiStyle : "bootstrap4",
															//iconSet : "fontAwesome",
															pager : '#pager',
															rowNum : 10,
															rowList : [ 1, 10,
																	20, 30 ],
															sortname : 'name',
															sortorder : 'asc',
															viewrecords : true,
															gridview : true,
															width : 900,
															//height : 200,
															//width : '800',
															//shrinkToFit : false,
															height : 'auto',
															//width : 500,
															//caption : '${labelContactList}',
															onSelectRow : function(
																	id) {
																document.location.href = "${showContactUrl}/"
																		+ id;
															},
															gridComplete : function() {
																var ids = jQuery(
																		"#list")
																		.jqGrid(
																				'getDataIDs');
																for (var i = 0; i < ids.length; i++) {
																	var cl = ids[i];
																	be = "<input style='height:22px;width:20px;' type='button' value='E' onclick=\"jQuery('#rowed2').editRow('"
																			+ cl
																			+ "');\"  />";
																	se = "<input style='height:22px;width:20px;' type='button' value='S' onclick=\"jQuery('#rowed2').saveRow('"
																			+ cl
																			+ "');\"  />";
																	ce = "<input style='height:22px;width:20px;' type='button' value='C' onclick=\"jQuery('#rowed2').restoreRow('"
																			+ cl
																			+ "');\" />";

                                                                   testEditThree=testEditTwo+'&id='+cl;
                                                                   testDeleteThree=testDeleteTwo+'&id='+cl;
                                                                   //console.log(testEditThree);
																   testEdit = "<a href='"+testEditThree+"'><button type='button' class='btn btn-light' aria-label='Edit user'> <i class='fas fa-pencil-alt'></i> </button></a>";
                                                                   testDelete = "  <a href='"+testDeleteThree+"'><button type='button' class='btn btn-light' aria-label='Delete user'> <i class='fas fa-trash-alt'></i> </button></a>";

																	jQuery(
																			"#list")
																			.jqGrid(
																					'setRowData',
																					ids[i],
																					{
																						act : testEdit
																								+ testDelete
																								///+ ce
																					});
																}
															}

														});
										//$("#list").jqGrid("setFrozenColumns");
										jQuery("#list").jqGrid('navGrid',
												"#pager", {
													edit : false,
													add : false,
													del : false,
													search : false
												});

									});
								</script>

    </div>




</body>
</html>