<?xml version="1.0" encoding="UTF-8"?>
<flow
    xmlns="http://www.springframework.org/schema/webflow"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://www.springframework.org/schema/webflow
        http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd"
    start-state="list">

    <secured
        attributes="ROLE_USER, ROLE_ADMIN"
        match="any" />


    <var
        name="servicio"
        class="com.home.budgetplanner.service.impl.TransactionTypeServiceImpl" />
    <on-start>
        <set
            name="flowScope.directorio"
            value="'transactionFlow'" />

    </on-start>

    <view-state
        id="list"
        view="#{directorio}/transactionList">

        <on-render>
            <evaluate
                expression="transactionsController.initializePeople()"
                result="flashScope.people" />
        </on-render>


        <transition
            on="search"
            to="list">

        </transition>
        <transition
            on="add"
            to="addEntity">
            <evaluate
                expression="transactionsController.initializeTransactionDTO()"
                result="flowScope.transaction" />
        </transition>

        <transition
            on="edit"
            to="editEntity">


            <evaluate
                expression="transactionsController.findById(requestParameters.id)"

                result="flowScope.transaction" />


        </transition>

        <transition
            on="delete"
            to="confirmDeleteEntity">
            <evaluate
                expression="transactionsController.findById(requestParameters.id)"
                result="flowScope.transaction" />
        </transition>
    </view-state>


    <view-state
        id="addEntity"
        view="#{directorio}/transactionCreate"
        model="transaction">

        <on-render>
            <evaluate
                expression="transactionsController.initializeSelectableTransactionTypes()"
                result="flashScope.selectableTransactionTypes" />
        </on-render>

        <transition
            on="save"
            to="confirmCreateEntity">
        </transition>

        <transition
            on="cancel"
            to="cancel"
            bind="false">
        </transition>

        <transition on="updateData">
            <!-- <render fragments="[//div[@id='data']]" /> -->
            <render fragments="hoteldata" />

        </transition>

    </view-state>

    <view-state
        id="confirmCreateEntity"
        view="#{directorio}/transactionConfirmCreate"
        model="transaction">


        <transition
            on="confirm"
            to="success">
            <evaluate expression="transactionsController.save(flowScope.transaction)" />
        </transition>

        <transition
            on="cancel"
            to="cancel"
            bind="false"></transition>


    </view-state>



    <view-state
        id="editEntity"
        view="#{directorio}/transactionEdit"
        model="transaction">
        
        
        <on-render>
            <evaluate
                expression="transactionsController.initializeSelectableTransactionTypesByEntry(transaction.transactionTypeEntryType)"
                result="flashScope.selectableTransactionTypes" />
                
                
        </on-render>




        <transition
            on="save"
            to="confirmEditEntity">
        </transition>

        <transition
            on="cancel"
            to="cancel"
            bind="false">
        </transition>
    </view-state>



    <view-state
        id="confirmEditEntity"
        view="#{directorio}/transactionConfirmEdit"
        model="transaction">


        <transition
            on="confirm"
            to="success">

            <evaluate expression="transactionsController.update(flowScope.transaction)" />
        </transition>



        <transition
            on="cancel"
            to="cancel"
            bind="false"></transition>


    </view-state>





    <view-state
        id="confirmDeleteEntity"
        view="#{directorio}/transactionConfirmDelete"
        model="transaction">


        <transition
            on="confirm"
            to="success">
            <evaluate expression="transactionsController.delete(flowScope.transaction)" />
        </transition>

        <transition
            on="cancel"
            to="cancel"
            bind="false"></transition>


    </view-state>



    <view-state id="failure" />


    <end-state id="success"></end-state>
    <end-state id="cancel"></end-state>

</flow>